drop trigger if exists remocao_efetivada_professor_update;
delimiter $$
 CREATE TRIGGER remocao_efetivada_professor_update
     BEFORE UPDATE ON remocaos
     FOR EACH ROW
    BEGIN
	IF new.remocao_efetiva = 1 then
		set new.status = 0;
	ELSE
		UPDATE acum_trabs SET valor_unid = old.valor_unid where professor_id = new.professor_id;
		UPDATE trabalhados SET unidade = old.unidade_atual where professor_id = new.professor_id and ano = year(curdate()) and ano_letivo = year(curdate());
		UPDATE trabalhados SET unidade = old.unidade_ant where professor_id = new.professor_id and ano = (year(curdate()) - 1) and ano_letivo = year(curdate());
	END IF;
    END$$
